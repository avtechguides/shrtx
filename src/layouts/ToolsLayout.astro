---
import Seo from '@components/Seo.astro';
import Header from '@components/sections/Header.astro';
import Footer from '@components/sections/Footer.astro';
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

// Minimal share widget reuse (optional): you can import ShareButtons if desired
// import ShareButtons from '@components/ui/share/ShareButtons.astro';

export interface Props {
  // SEO / header
  title: string;
  description?: string;
  path?: string;            // canonical path starting with '/'
  image?: ImageMetadata;    // optional hero image
  imageAlt?: string;

  // UI
  showHeader?: boolean;
  noindex?: boolean;

  // Optional meta for tools
  category?: string;
  popularity?: number;
  isPremium?: boolean;
}

const {
  title,
  description = '',
  path = Astro.url.pathname,
  image,
  imageAlt,
  showHeader = true,
  noindex = false,
  category,
  popularity,
  isPremium,
} = Astro.props as Props;

const canonicalUrl = new URL(path, Astro.url).toString();
---
<html lang="en" data-theme="dark" class="dark">
  <head>
    <Seo
      title={title}
      description={description}
      path={path}
      image={image}
      type="page"
      noindex={noindex}
    />
  </head>
  <body class="bg-[var(--color-bg-primary)] text-[var(--color-text-primary)] transition-colors duration-300">
    <Header />
    <main>
      <article>
        {showHeader && (
          <div class="hero-image">
            {image && <Image width={1020} height={510} src={image} alt={imageAlt ?? title} />}
          </div>
        )}

        <div class="prose">
          {showHeader && (
            <header class="title">
              <h1>{title}</h1>
              {description && <p class="subtitle">{description}</p>}
              {(category || popularity !== undefined || isPremium !== undefined) && (
                <div class="tool-meta">
                  {category && <span class="badge">Category: {category}</span>}
                  {popularity !== undefined && <span class="badge">Popularity: {popularity}</span>}
                  {isPremium !== undefined && <span class="badge">{isPremium ? 'Premium' : 'Free'}</span>}
                </div>
              )}
              <hr />
            </header>
          )}

          {/* Optional share buttons
          <ShareButtons title={title} url={canonicalUrl} />
          */}

          <slot />
        </div>
      </article>
    </main>
    <Footer />
  </body>
</html>

<style>
  main {
    width: 1280px;
    max-width: calc(100% - 2em);
    margin: auto;
    background: var(--color-bg-primary);
  }
  .hero-image { width: 100%; }
  .hero-image img {
    display: block;
    margin: 0 auto;
    border-radius: 12px;
    box-shadow: var(--box-shadow);
  }
  .prose {
    width: 100%;
    max-width: 870px;
    margin: auto;
    padding: 0.05em;
    color: var(--color-text-secondary);
  }
  .title {
    margin-bottom: 1em;
    padding: 1em 0;
    text-align: center;
    line-height: 1.2;
  }
  .title h1 {
    margin: 0 0 0.25em 0;
    color: var(--color-text-primary);
  }
  .subtitle {
    margin: 0.25em 0 0.75em;
    color: var(--color-text-muted);
  }
  .tool-meta {
    display: flex;
    justify-content: center;
    gap: 0.5rem;
    flex-wrap: wrap;
    margin-bottom: 0.5rem;
  }
  .badge {
    font-size: 0.85rem;
    color: var(--color-text-muted);
    border: 1px solid var(--color-border);
    border-radius: 999px;
    padding: 0.15rem 0.6rem;
  }
</style>
