---
import ToolsLayout from '../../layouts/ToolsLayout.astro';
import ToolFeatures from '../../components/ui/tools/ToolFeatures.astro';
import ToolNav from '../../components/ui/nav/ToolNav.astro';
import { tools } from '@data/tools/tools';
import { slugifyTag } from '@lib/slug';
import type { Tool } from '@data/tools/tools';

// Define the tool info
const tool: Tool = {
  slug: 'broken-link',
  title: 'Broken Link Checker',
  description: 'Check for broken links on any website quickly and easily.',
  category: 'URL & Link Tools',
  categorySlug: 'url-tools',
  icon: 'ðŸ”—',
  popularity: 88,
  href: '/tools/url/broken-link',
  features: [
    'Check multiple URLs at once',
    'Detect 404 and broken links',
    'Fast and reliable results',
    'Copy results for reporting'
  ],
  isPremium: false,
};

// Page meta
const pageTitle = `${tool.title} - SHRTX Tools`;
const pageDescription = tool.description ?? '';
const path = `/tools/${tool.slug}`;

// Neighbor navigation
const sorted = [...tools].filter(t => !!t.slug).sort((a, b) => a.title.localeCompare(b.title));
const idx = sorted.findIndex(t => t.slug === tool.slug);
const prevTool = idx > 0 ? sorted[idx - 1] : null;
const nextTool = idx >= 0 && idx < sorted.length - 1 ? sorted[idx + 1] : null;

const categoryHref = `/tools/categories/${slugifyTag(tool.category)}`;
---

<ToolsLayout
  title={pageTitle}
  description={pageDescription}
  path={path}
  category={tool.category}
  popularity={tool.popularity}
  isPremium={tool.isPremium}
  showHeader={true}
>
  <!-- Breadcrumb -->
  <p class="text-sm text-[var(--color-text-muted)] mb-4">
    <a href="/tools" class="hover:underline">Tools</a> â€¢
    <a href={categoryHref} class="hover:underline">{tool.category}</a>
  </p>

  <!-- Tool Description -->
  <section class="space-y-4">
    <h2 class="text-2xl font-semibold">About this tool</h2>
    <p>{tool.description}</p>
  </section>

  <!-- Tool Features -->
  {tool.features && tool.features.length > 0 && (
    <ToolFeatures features={tool.features} />
  )}

  <!-- Prev/Next Navigation -->
  <ToolNav
    prev={prevTool ? { id: prevTool.slug!, title: prevTool.title } : null}
    next={nextTool ? { id: nextTool.slug!, title: nextTool.title } : null}
  />

  <!-- Tool Scripts -->
  <script type="module" src="../../../scripts/url/broken-link.js"></script>
  <script type="module" src="../../../scripts/url/url.js"></script>
</ToolsLayout>
